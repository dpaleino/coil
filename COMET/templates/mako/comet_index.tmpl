<%inherit file="base.tmpl"/>
<%block name="extra_head">
<style>
.list-group {
    margin-top: 10px;
}
</style>
</%block>
<%block name="extra_js">
<script>
$('#deleteModal').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget);
    var title = button.data('ptitle');
    var sourcepath = button.data('sourcepath');
    var modal = $(this);
    modal.find('.del-title').text(title);
    modal.find('.sourcepath').val(sourcepath);
});
</script>
</%block>
<%block name="content">

<div class="row">
    <div class="col-md-6">
        <h2 style="text-align: center;">Posts</h2>
        <form method="POST" action="/new/post" class="input-group">
              <input class="form-control" name="title" id="title" placeholder="Title">
              <span class="input-group-btn"><button type="submit" class="btn btn-success"><i class="fa fa-file-o"></i> Create Post</button></span>
        </form>
        <div class="list-group">
        % for p in site.posts:
            <div class="list-group-item">
                <h3 class="media-heading">${p.title()}</h3>
                <small>Date: ${p.date}</small>
                <br><small>Author: ${p.meta('author')}</small>
                <div class="pull-right">
                    <a class="btn btn-info btn-xs" href="/edit/${p.source_path}"><i class="fa fa-pencil"></i> Edit</a>
                    <button type="button" class="btn btn-danger btn-xs" data-toggle="modal" data-target="#deleteModal" data-sourcepath="${p.source_path}" data-ptitle="${p.title()}"><i class="fa fa-trash"></i> Delete</a>
                </div>
            </div>
        % endfor
        </div>
    </div>

    <div class="col-md-6">
        <h2 style="text-align: center;">Pages</h2>
        <form method="POST" action="/new/page" class="input-group">
              <input class="form-control" name="title" id="title" placeholder="Title">
              <span class="input-group-btn"><button type="submit" class="btn btn-success"><i class="fa fa-file-o"></i> Create Page</button></span>
        </form>
        <div class="page_holder"></div>
        <div class="list-group">
        % for p in site.pages:
            <div class="list-group-item">
                <h3 class="media-heading">${p.title()}</h3>
                <small>Date: ${p.date}</small>
                <br><small>Author: ${p.meta('author')}</small>
                <div class="pull-right">
                    <a class="btn btn-info btn-xs" href="/edit/${p.source_path}"><i class="fa fa-pencil"></i> Edit</a>
                    <button type="button" class="btn btn-danger btn-xs" data-toggle="modal" data-target="#deleteModal" data-sourcepath="${p.source_path}" data-ptitle="${p.title()}"><i class="fa fa-trash"></i> Delete</a>
                </div>
            </div>
        % endfor
        </div>
        <div class="page_holder"></div>
    </div>
</div>

<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="deleteModalLabel">Confirm deletion</h4>
      </div>
      <div class="modal-body">
      Really delete <span class="del-title">post</span>?
      </div>
      <div class="modal-footer">
        <form method="POST" action="/delete" class="delete-button">
        <input type="hidden" name="path" class="sourcepath">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-danger">Delete</button>
      </div>
    </div>
  </div>
</div>
</%block>
